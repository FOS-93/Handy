<div class="container">
  <div class="d-flex justify-content-center mt-2 img-more-info" style="border-radius: 20px;">
    <div class="img-show" style="margin: 78px 0px 0px 0px;">
      <%= cl_image_tag(@handyman.user.photo.key) %>
    </div>
  </div>
  <br>
  <br>
  <br>
  <br>
  <br>
  <div style="display: grid;">
    <div class="row">
      <div class="col-8">
        <div class="d-flex">
          <div>
            <% @handyman.skills.each do |skill| %>
            <h3><%= @handyman.user.full_name%> <%= icons_for_skills(skill.name) %></h3>
          </div>
          <div>
            <% if @handyman.chatrooms.where(user_id: current_user.id).present? %>
              <%= link_to "Chat and arrange details", chatroom_path(@handyman.chatrooms.where(user_id: current_user.id).first), class:"btn btn-info", style:"margin-left: 80px;" %>
            <% else %>
              <%= link_to "Chat and arrange details", handyman_chatrooms_path(@handyman), method:"post", class:"btn btn-info", style:"margin-left: 80px;" %>
            <% end %>
          </div>
        </div>
        <!-- linea -->
        <div class="linea"></div>
        <% @handyman.skills.each do |skill| %>
              <div class="skill">
                <p class= "<%=badges_for_skills(skill.name) %> mb-0"> <%= icons_for_skills(skill.name) %><%= skill.name %></p>
                <p class= "level small fw-light"><%= skill.level %></p>
              </div>
        <% end %>
        <p><%= skill.description %></p>
        <% end %>
         <% if @handyman.rating_count.zero? %>
         <p></p>
         <%else%>
         <div class="linea"></div>
         <h4>Reviews</h4>
          <% @reviews_handyman.each do |r| %>
          <div>
            <div class="d-flex">
              <div class="img-reviews">
                <%= cl_image_tag(r.user.photo.key) %>
              </div>
              <div>
                <div class="d-flex" style="margin-left: 10px;">
                  <p style="margin: 0px;"><%= r.user.full_name %></p>
                  <p style="margin: 0px 0px 0px 25px;"><%= '<i class="fas fa-solid fa-star"></i>'.html_safe * r.stars %></p>
                </div>
                <div style="margin-left: 10px;">
                  <p><%= r.created_at.strftime('%B %e, %Y') %></p>
                </div>
              </div>
            </div>
            <p><%= r.content %></p>
          </div>
          <% end %>
          <% end %>

      </div>

      <div class="col-4 appointment">
        <div class="formulario">
          <h4>New appointment with <%= @handyman.user.first_name %></h4>
           <%= simple_form_for [@handyman, @appointment] do |f|  %>
            <%= f.input :date %>
            <%= f.input :description %>
            <%= f.input :skill, :collection => @handyman.skills %>
            <div class="btn-submit-2">
            <%= f.submit %>
            </div>
          <% end %>
          </div>
        </div>
      </div>
    </div>
    <div class="linea"></div>
    <!-- Map -->
    <div>
    <div class="" style="width: 100%; height: 400px; margin-right: 31px; top: 20px; border-radius: 23px;"
            data-controller="mapbox"
            data-mapbox-markers-value="<%= @marker.to_json %>"
            data-mapbox-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>" >
            </div>
    </div>
  </div>

</div>
  <div>
    <%= link_to 'Back', handymen_path, class:"btn btn-info"%>
  </div>
<%= render 'shared/footer' %>
